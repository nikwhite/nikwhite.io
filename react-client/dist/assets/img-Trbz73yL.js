import{r as s,j as t,c as E}from"./client-BCr4-QWM.js";const $="https://storage.googleapis.com/storage/v1/b/nikwhite.io/o",h={prefix:"static/photos/",includeFoldersAsPrefixes:"true",delimiter:"/"},j={background:"none",border:"none",padding:"8px 16px",cursor:"pointer",fontSize:"18px"},y={background:"none",border:"none",padding:"8px 16px",cursor:"pointer",marginBottom:"16px",fontSize:"18px"},S={marginBottom:"8px"};function C(){return new URLSearchParams(window.location.search).get("path")||""}const v=()=>{const[a,k]=s.useState([]),[P,l]=s.useState(!1),[x,f]=s.useState(null),[o,u]=s.useState(C());s.useEffect(()=>{const e=n=>{const d=n.state?.path||"";u(d)};return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},[]);const p=e=>{const n=new URL(window.location.href);e?n.searchParams.set("path",e):n.searchParams.delete("path"),e!==o&&(window.history.pushState({path:e},"",n.toString()),u(e))};function b(){const e=/\.[a-zA-Z0-9]{2,5}$/.test(o)?-1:-2;return o.split("/").slice(0,e).concat("").join("/")}if(s.useEffect(()=>{l(!0),f(null);const e=new URLSearchParams(h),n=o?`${h.prefix}${o}`:h.prefix;e.set("prefix",n);const d=`${$}?${e.toString()}`;fetch(d).then(r=>r.json()).then(r=>{const m=[],g=[];if(r.prefixes)for(const c of r.prefixes){const i=c.replace(n,"");i&&m.push({type:"folder",name:i})}if(r.items)for(const c of r.items){const i=c.name.replace(n,"");i&&!i.endsWith("/")&&g.push({name:i,type:"photo",downloadUri:c.mediaLink})}k([...m,...g]),l(!1)}).catch(()=>{f("Failed to load photos"),l(!1)})},[o]),o&&!o.endsWith("/")){const e=`https://storage.googleapis.com/nikwhite.io/static/photos/${o}`;return t.jsxs("section",{children:[t.jsx("div",{children:t.jsx("button",{style:y,onClick:()=>window.history.back(),children:"← Back"})}),t.jsx("img",{src:e,alt:o,style:{maxWidth:"100%",maxHeight:"80vh"}})]})}return t.jsxs("section",{children:[t.jsx("h2",{children:`nikwhite.io > ${o||""}`}),P&&t.jsx("p",{children:"Loading..."}),x&&t.jsx("p",{style:{color:"red"},children:x}),t.jsx("ul",{style:{listStyle:"none",padding:0},children:a.map((e,n)=>e.type==="folder"?t.jsx("li",{style:S,children:t.jsxs("button",{style:j,onClick:()=>p(o?`${o}${e.name}`:e.name),children:["➳ ",e.name]})},n):t.jsx("li",{style:S,children:t.jsx("button",{style:j,onClick:()=>p(o?`${o}${e.name}`:e.name),children:e.name})},n))}),o&&t.jsx("button",{style:y,onClick:()=>p(b()),children:"← Back"})]})},B=()=>t.jsxs("div",{style:{padding:"8px 16px 16px",fontFamily:"Arial, sans-serif"},children:[t.jsx("h1",{children:"Photos"}),t.jsx(v,{})]}),w=document.getElementById("root");w?E.createRoot(w).render(t.jsx(s.StrictMode,{children:t.jsx(B,{})})):console.error("Container element not found.");
